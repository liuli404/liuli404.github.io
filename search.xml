<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>kafka</title>
      <link href="/2023/02/17/kafka/"/>
      <url>/2023/02/17/kafka/</url>
      
        <content type="html"><![CDATA[<h1 id="一、集群环境"><a href="#一、集群环境" class="headerlink" title="一、集群环境"></a>一、集群环境</h1><table><thead><tr><th>IP地址</th><th>角色</th></tr></thead><tbody><tr><td>10.11.113.181</td><td>源端：zk 集群、kafka 集群</td></tr><tr><td>10.11.113.182</td><td>源端：zk 集群、kafka 集群</td></tr><tr><td>10.11.113.183</td><td>源端：zk 集群、kafka 集群</td></tr><tr><td>10.11.113.184</td><td>目标端：zk 集群、kafka 集群</td></tr><tr><td>10.11.113.185</td><td>目标端：zk 集群、kafka 集群</td></tr><tr><td>10.11.113.186</td><td>目标端：zk 集群、kafka 集群</td></tr></tbody></table><p><img src="/2023/02/17/kafka/image-20220721175245734.png" alt="image-20220721175245734"></p><h1 id="二、JDK-环境"><a href="#二、JDK-环境" class="headerlink" title="二、JDK 环境"></a>二、JDK 环境</h1><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> jdk-8u321-linux-x64.tar.gz <span class="token parameter variable">-C</span> /opt<span class="token builtin class-name">echo</span> <span class="token string">"export PATH=<span class="token environment constant">$PATH</span>:/opt/jdk1.8.0_321/bin"</span> <span class="token operator">>></span> ~/.bashrc<span class="token builtin class-name">source</span> ~/.bashrc</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># java -version</span><span class="token function">java</span> version <span class="token string">"1.8.0_321"</span>Java<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> SE Runtime Environment <span class="token punctuation">(</span>build <span class="token number">1.8</span>.0_321-b07<span class="token punctuation">)</span>Java HotSpot<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> <span class="token number">64</span>-Bit Server VM <span class="token punctuation">(</span>build <span class="token number">25.321</span>-b07, mixed mode<span class="token punctuation">)</span></code></pre><h1 id="三、Zookeeper-集群"><a href="#三、Zookeeper-集群" class="headerlink" title="三、Zookeeper 集群"></a>三、Zookeeper 集群</h1><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> apache-zookeeper-3.7.1-bin.tar.gz <span class="token parameter variable">-C</span> /opt<span class="token builtin class-name">cd</span> /opt/apache-zookeeper-3.7.1-bin/</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> dataLog data</code></pre><p>注意 myid 内的数字不能重复，作为 zookeeper 的独立标志</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 身份标识，区别其他 zookeeper</span><span class="token builtin class-name">echo</span> <span class="token number">1</span> <span class="token operator">></span> data/myid<span class="token builtin class-name">echo</span> <span class="token number">2</span> <span class="token operator">></span> data/myid<span class="token builtin class-name">echo</span> <span class="token number">3</span> <span class="token operator">></span> data/myid</code></pre><p>修改配置文件</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> conf/zoo_sample.cfg conf/zoo.cfg</code></pre><p>修改内容</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">dataDir</span><span class="token operator">=</span>/opt/apache-zookeeper-3.7.1-bin/data/<span class="token assign-left variable">dataLogDir</span><span class="token operator">=</span>/opt/apache-zookeeper-3.7.1-bin/dataLog/<span class="token assign-left variable">server.1</span><span class="token operator">=</span><span class="token number">10.11</span>.113.181:2888:3888<span class="token assign-left variable">server.2</span><span class="token operator">=</span><span class="token number">10.11</span>.113.182:2888:3888<span class="token assign-left variable">server.3</span><span class="token operator">=</span><span class="token number">10.11</span>.113.183:2888:3888</code></pre><p>添加环境变量</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"export PATH=<span class="token environment constant">$PATH</span>:/opt/apache-zookeeper-3.7.1-bin/bin"</span> <span class="token operator">>></span> ~/.bashrc<span class="token builtin class-name">source</span> ~/.bashrc</code></pre><p>启动 zookeeper</p><pre class="language-bash" data-language="bash"><code class="language-bash">zkServer.sh start</code></pre><p>查看状态</p><pre class="language-bash" data-language="bash"><code class="language-bash">zkServer.sh status</code></pre><h1 id="四、Kafka-集群"><a href="#四、Kafka-集群" class="headerlink" title="四、Kafka 集群"></a>四、Kafka 集群</h1><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> kafka_2.13-2.7.0.tgz <span class="token parameter variable">-C</span> /opt<span class="token builtin class-name">cd</span> /opt/kafka_2.13-2.7.0</code></pre><p>编辑配置文件</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> config/server.properties</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># kafka 身份标识，区别其他 kafka</span><span class="token assign-left variable">broker.id</span><span class="token operator">=</span><span class="token number">1</span><span class="token comment"># 当前主机 IP</span><span class="token assign-left variable">listeners</span><span class="token operator">=</span>PLAINTEXT://10.11.113.181:9092<span class="token comment"># 广播地址</span><span class="token assign-left variable">advertised.listeners</span><span class="token operator">=</span>PLAINTEXT://10.11.113.181:9092<span class="token comment"># 日志数据文件</span><span class="token assign-left variable">log.dirs</span><span class="token operator">=</span>/opt/kafka_2.13-2.7.0/logs<span class="token comment"># zookeeper 集群地址</span><span class="token assign-left variable">zookeeper.connect</span><span class="token operator">=</span><span class="token number">10.11</span>.113.181:2181,10.11.113.182:2181,10.11.113.183:2181</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"export PATH=<span class="token environment constant">$PATH</span>:/opt/kafka_2.13-2.7.0/bin"</span> <span class="token operator">>></span> ~/.bashrc<span class="token builtin class-name">source</span> ~/.bashrc</code></pre><p>启动 kafka 集群</p><pre class="language-bash" data-language="bash"><code class="language-bash">bin/kafka-server-start.sh <span class="token parameter variable">-daemon</span> config/server.propertiestailf logs/server.log</code></pre><p>查看进程含有 <code>QuorumPeerMain、Kafka</code></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># jps</span><span class="token number">3378</span> Jps<span class="token number">2726</span> QuorumPeerMain<span class="token number">3278</span> Kafka</code></pre><h1 id="五、Kafka-集群测试"><a href="#五、Kafka-集群测试" class="headerlink" title="五、Kafka 集群测试"></a>五、Kafka 集群测试</h1><h2 id="5-1-创建-topic"><a href="#5-1-创建-topic" class="headerlink" title="5.1 创建 topic"></a>5.1 创建 topic</h2><pre class="language-bash" data-language="bash"><code class="language-bash">bin/kafka-topics.sh <span class="token parameter variable">--zookeeper</span> <span class="token number">10.11</span>.113.181:2181 <span class="token punctuation">\</span>  <span class="token parameter variable">--create</span> <span class="token punctuation">\</span>  <span class="token parameter variable">--topic</span> my-test-topic <span class="token punctuation">\</span>  --replication-factor <span class="token number">2</span> <span class="token punctuation">\</span>  <span class="token parameter variable">--partitions</span> <span class="token number">1</span></code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 参数解释</span>--topic: topic 名称--replication-factor: 副本数量--partitions: 分区数量</code></pre><h2 id="5-2-查看当-topic-列表"><a href="#5-2-查看当-topic-列表" class="headerlink" title="5.2 查看当 topic 列表"></a>5.2 查看当 topic 列表</h2><pre class="language-bash" data-language="bash"><code class="language-bash">bin/kafka-topics.sh <span class="token parameter variable">--zookeeper</span> <span class="token number">10.11</span>.113.181:2181 <span class="token parameter variable">--list</span></code></pre><h2 id="5-3-查看-topic-详细信息"><a href="#5-3-查看-topic-详细信息" class="headerlink" title="5.3 查看 topic 详细信息"></a>5.3 查看 topic 详细信息</h2><pre class="language-bash" data-language="bash"><code class="language-bash">bin/kafka-topics.sh <span class="token parameter variable">--zookeeper</span> <span class="token number">10.11</span>.113.181:2181 <span class="token parameter variable">--describe</span> <span class="token parameter variable">--topic</span> my-test-topic</code></pre><h2 id="5-4-消息生产者"><a href="#5-4-消息生产者" class="headerlink" title="5.4 消息生产者"></a>5.4 消息生产者</h2><p>运行一个消息生产者，指定 topic 为刚刚创建的 my-test-topic</p><pre class="language-bash" data-language="bash"><code class="language-bash">$ bin/kafka-console-producer.sh --bootstrap-server <span class="token number">10.11</span>.113.181:9092 <span class="token parameter variable">--topic</span> my-test-topic<span class="token operator">></span><span class="token number">1</span><span class="token operator">></span><span class="token number">2</span><span class="token operator">></span><span class="token number">3</span><span class="token operator">></span><span class="token number">4</span><span class="token operator">></span><span class="token number">5</span><span class="token operator">></span><span class="token number">6</span><span class="token operator">></span><span class="token number">7</span><span class="token operator">></span><span class="token number">8</span><span class="token operator">></span><span class="token number">9</span></code></pre><h2 id="5-5-消息消费者"><a href="#5-5-消息消费者" class="headerlink" title="5.5 消息消费者"></a>5.5 消息消费者</h2><p>运行一个消息消费者，同样指定 topic 为 my-test-topic</p><pre class="language-bash" data-language="bash"><code class="language-bash">--from-beginning: 从头开始接收消息</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash">$ bin/kafka-console-consumer.sh --bootstrap-server <span class="token number">10.11</span>.113.181:9092 <span class="token parameter variable">--topic</span> my-test-topic --from-beginning<span class="token number">1</span><span class="token number">2</span><span class="token number">3</span><span class="token number">4</span><span class="token number">5</span><span class="token number">6</span><span class="token number">7</span><span class="token number">8</span><span class="token number">9</span></code></pre><h2 id="5-6-删除-topic"><a href="#5-6-删除-topic" class="headerlink" title="5.6 删除 topic"></a>5.6 删除 topic</h2><pre class="language-bash" data-language="bash"><code class="language-bash">bin/kafka-topics.sh <span class="token parameter variable">--zookeeper</span> <span class="token number">10.11</span>.113.181:2181 <span class="token parameter variable">--delete</span> <span class="token parameter variable">--topic</span> my-test-topic</code></pre><p>想要彻底删除 topic，需要一个参数处于启用状态： <code>delete.topic.enable = true</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>测试页面</title>
      <link href="/2023/02/17/%E6%B5%8B%E8%AF%95%E9%A1%B5%E9%9D%A2/"/>
      <url>/2023/02/17/%E6%B5%8B%E8%AF%95%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<h1 id="一、软件版本"><a href="#一、软件版本" class="headerlink" title="一、软件版本"></a>一、软件版本</h1><table><thead><tr><th>软件</th><th>版本</th><th>下载链接</th></tr></thead><tbody><tr><td>Wordpress</td><td>6.0</td><td><a href="https://cn.wordpress.org/wordpress-6.0-zh_CN.tar.gz">https://cn.wordpress.org/wordpress-6.0-zh_CN.tar.gz</a></td></tr><tr><td>Apache</td><td>2.4.53</td><td><a href="https://dlcdn.apache.org/httpd/httpd-2.4.53.tar.gz">https://dlcdn.apache.org/httpd/httpd-2.4.53.tar.gz</a></td></tr><tr><td>APR</td><td>1.7.0</td><td><a href="https://dlcdn.apache.org//apr/apr-1.7.0.tar.gz">https://dlcdn.apache.org//apr/apr-1.7.0.tar.gz</a></td></tr><tr><td>APR-util</td><td>1.6.1</td><td><a href="https://dlcdn.apache.org//apr/apr-util-1.6.1.tar.gz">https://dlcdn.apache.org//apr/apr-util-1.6.1.tar.gz</a></td></tr><tr><td>MySQL</td><td>5.7.35</td><td><a href="https://cdn.mysql.com/archives/mysql-5.7/mysql-boost-5.7.35.tar.gz">https://cdn.mysql.com/archives/mysql-5.7/mysql-boost-5.7.35.tar.gz</a></td></tr><tr><td>PHP</td><td>7.4.28</td><td><a href="https://www.php.net/distributions/php-7.4.28.tar.gz">https://www.php.net/distributions/php-7.4.28.tar.gz</a></td></tr></tbody></table><h1 id="二、环境初始化"><a href="#二、环境初始化" class="headerlink" title="二、环境初始化"></a>二、环境初始化</h1><p>服务器配置</p><pre class="language-bash" data-language="bash"><code class="language-bash">系统：CentOS <span class="token number">7.6</span>.1810 IP：10.11.109.201CPU：8线程内存：16G硬盘：200G</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 关闭防火墙、Selinux</span>systemctl stop firewalld.service <span class="token operator">&amp;&amp;</span> systemctl disable firewalld.servicesystemctl stop NetworkManager <span class="token operator">&amp;&amp;</span> systemctl disable NetworkManagersetenforce <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s/enforcing/disabled/g'</span> /etc/selinux/config<span class="token comment"># 配置 YUM 源</span><span class="token function">mv</span> /etc/yum.repos.d/CentOS-* /tmp/<span class="token function">curl</span> <span class="token parameter variable">-o</span> /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo<span class="token function">curl</span> <span class="token parameter variable">-o</span> /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repoyum clean all <span class="token operator">&amp;&amp;</span> yum makecache<span class="token comment"># 安装基本工具</span>yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">vim</span> <span class="token function">wget</span> <span class="token function">lsof</span> net-tools bash-completion lrzsz <span class="token function">unzip</span><span class="token builtin class-name">source</span> /usr/share/bash-completion/bash_completion<span class="token comment"># 最大打开文件数</span><span class="token function">cat</span> <span class="token operator">>></span> /etc/security/limits.conf <span class="token operator">&lt;&lt;</span><span class="token string">EOF* soft nofile 102400* hard nofile 204800EOF</span><span class="token comment"># 最大进程数</span><span class="token function">cat</span> <span class="token operator">></span> /etc/security/limits.d/20-nproc.conf <span class="token operator">&lt;&lt;</span><span class="token string">EOF* soft nproc 102400* hard nproc 204800EOF</span><span class="token comment"># 内核参数优化</span><span class="token function">cat</span> <span class="token operator">>></span> /etc/sysctl.conf <span class="token operator">&lt;&lt;</span> <span class="token string">EOFnet.ipv6.conf.all.disable_ipv6 = 1net.ipv6.conf.default.disable_ipv6 = 1net.ipv4.icmp_echo_ignore_broadcasts = 1net.ipv4.tcp_syncookies = 1kernel.msgmnb = 65536kernel.msgmax = 65536net.ipv4.tcp_max_tw_buckets = 6000net.ipv4.tcp_sack = 1net.ipv4.tcp_window_scaling = 1net.ipv4.tcp_rmem = 4096 87380 4194304net.ipv4.tcp_wmem = 4096 16384 4194304net.core.wmem_default = 8388608net.core.rmem_default = 8388608net.core.rmem_max = 16777216net.core.wmem_max = 16777216net.ipv4.tcp_tw_recycle = 1vm.max_map_count = 655360EOF</span><span class="token function">sysctl</span> <span class="token parameter variable">-p</span></code></pre><h1 id="三、软件安装"><a href="#三、软件安装" class="headerlink" title="三、软件安装"></a>三、软件安装</h1><h2 id="编译环境"><a href="#编译环境" class="headerlink" title="编译环境"></a>编译环境</h2><pre class="language-bash" data-language="bash"><code class="language-bash">yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token punctuation">\</span>  openssl-devel <span class="token punctuation">\</span>  expat-devel <span class="token punctuation">\</span>  zlib-devel <span class="token punctuation">\</span>  pcre-devel <span class="token punctuation">\</span>  ncurses-devel <span class="token punctuation">\</span>  sqlite-devel <span class="token punctuation">\</span>  oniguruma-devel <span class="token punctuation">\</span>  libaio-devel <span class="token punctuation">\</span>  libxml2-devel <span class="token punctuation">\</span>  libjpeg-devel <span class="token punctuation">\</span>  libpng-devel <span class="token punctuation">\</span>  libcurl-devel <span class="token punctuation">\</span>  libzip-devel <span class="token punctuation">\</span>  freetype-devel <span class="token punctuation">\</span>  cmake <span class="token function">make</span> gcc gcc-c++</code></pre><h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><p><strong>卸载自带的 mariadb</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash">yum remove <span class="token parameter variable">-y</span>  mariadb* <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> <span class="token parameter variable">-f</span> /etc/my.cnf</code></pre><p><strong>创建 mysql 用户</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">useradd</span> <span class="token parameter variable">-r</span> <span class="token parameter variable">-s</span> /sbin/nologin mysql</code></pre><p><strong>解压源码包</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> mysql-boost-5.7.35.tar.gz</code></pre><p><strong>进入解压后的目录</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> mysql-5.7.35</code></pre><p><strong>配置</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash">cmake <span class="token builtin class-name">.</span> <span class="token punctuation">\</span><span class="token parameter variable">-DCMAKE_INSTALL_PREFIX</span><span class="token operator">=</span>/data/mysql <span class="token punctuation">\</span><span class="token parameter variable">-DMYSQL_DATADIR</span><span class="token operator">=</span>/data/mysql/data <span class="token punctuation">\</span><span class="token parameter variable">-DSYSCONFDIR</span><span class="token operator">=</span>/data/mysql <span class="token punctuation">\</span><span class="token parameter variable">-DMYSQL_TCP_PORT</span><span class="token operator">=</span><span class="token number">3306</span> <span class="token punctuation">\</span><span class="token parameter variable">-DMYSQL_UNIX_ADDR</span><span class="token operator">=</span>/data/mysql/mysql.sock <span class="token punctuation">\</span><span class="token parameter variable">-DWITH_INNOBASE_STORAGE_ENGINE</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\</span><span class="token parameter variable">-DWITH_PARTITION_STORAGE_ENGINE</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\</span><span class="token parameter variable">-DWITH_FEDERATED_STORAGE_ENGINE</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\</span><span class="token parameter variable">-DWITH_BLACKHOLE_STORAGE_ENGINE</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\</span><span class="token parameter variable">-DWITH_MYISAM_STORAGE_ENGINE</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\</span><span class="token parameter variable">-DENABLED_LOCAL_INFILE</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\</span><span class="token parameter variable">-DEXTRA_CHARSETS</span><span class="token operator">=</span>all <span class="token punctuation">\</span><span class="token parameter variable">-DDEFAULT_CHARSET</span><span class="token operator">=</span>utf8mb4 <span class="token punctuation">\</span><span class="token parameter variable">-DDEFAULT_COLLATION</span><span class="token operator">=</span>utf8mb4_general_ci <span class="token punctuation">\</span><span class="token parameter variable">-DWITH_SSL</span><span class="token operator">=</span>system <span class="token punctuation">\</span><span class="token parameter variable">-DWITH_BOOST</span><span class="token operator">=</span>boost</code></pre><p><strong>编译安装</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">make</span> <span class="token parameter variable">-j</span> <span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> /proc/cpuinfo <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'processor'</span> <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">`</span></span><span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span></code></pre><p><strong>创建 mysql-files 目录并设置 750 权限</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> /data/mysql/mysql-files <span class="token operator">&amp;&amp;</span> <span class="token function">chmod</span> <span class="token number">750</span> /data/mysql/mysql-files</code></pre><p><strong>创建配置文件</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /data/mysql/my.cnf---<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span><span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">3306</span><span class="token assign-left variable">basedir</span><span class="token operator">=</span>/data/mysql/<span class="token assign-left variable">datadir</span><span class="token operator">=</span>/data/mysql//data<span class="token assign-left variable">socket</span><span class="token operator">=</span>/data/mysql/mysql.sock</code></pre><p><strong>初始化数据库</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">chown</span> <span class="token parameter variable">-R</span> mysql:mysql /data/mysql/</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /data/mysql<span class="token comment"># 这一步将获取 MySQL 初始密码</span>bin/mysqld --defaults-file<span class="token operator">=</span>/data/mysql/my.cnf <span class="token parameter variable">--initialize</span> <span class="token parameter variable">--user</span><span class="token operator">=</span>mysql <span class="token parameter variable">--basedir</span><span class="token operator">=</span>/data/mysql/</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash">bin/mysql_ssl_rsa_setup <span class="token parameter variable">--datadir</span><span class="token operator">=</span>/data/mysql/data</code></pre><p><strong>启动 MySQL</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> support-files/mysql.server /etc/init.d/mysqld<span class="token function">chmod</span> +x /etc/init.d/mysqld</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">service</span> mysqld start <span class="token operator">&amp;&amp;</span> <span class="token function">chkconfig</span> <span class="token parameter variable">--add</span> mysqld</code></pre><p><strong>配置环境变量</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> ~/.bashrc---<span class="token comment"># mysql</span><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span>:/data/mysql/bin/</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">source</span> ~/.bashrc</code></pre><p>修改 root 密码及权限</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># mysql -u root -p</span>Enter password: <span class="token comment"># 这里输入初始密码</span>mysql<span class="token operator">></span> <span class="token keyword">set</span> password <span class="token keyword">for</span> root<span class="token variable">@localhost</span> <span class="token operator">=</span> password<span class="token punctuation">(</span><span class="token string">'123456Aa.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>mysql<span class="token operator">></span> <span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">privileges</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> <span class="token string">'root'</span><span class="token variable">@'%'</span> identified <span class="token keyword">by</span> <span class="token string">'123456Aa.'</span><span class="token punctuation">;</span>mysql<span class="token operator">></span> flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>mysql<span class="token operator">></span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> wordpress <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci<span class="token punctuation">;</span></code></pre><h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><p><strong>创建用户</strong></p><pre class="language-none"><code class="language-none">useradd php -s &#x2F;sbin&#x2F;nologin</code></pre><p><strong>解压安装包</strong></p><pre class="language-none"><code class="language-none">tar -zxvf php-7.4.28.tar.gz</code></pre><p><strong>进入解压后的目录</strong></p><pre class="language-none"><code class="language-none">cd php-7.4.28</code></pre><p><strong>配置</strong></p><pre class="language-none"><code class="language-none">.&#x2F;configure \--prefix&#x3D;&#x2F;data&#x2F;php \--with-config-file-path&#x3D;&#x2F;data&#x2F;php&#x2F;etc \--with-fpm-user&#x3D;php \--with-fpm-group&#x3D;php \--with-mysqli&#x3D;mysqlnd \--with-pdo-mysql&#x3D;mysqlnd \--with-apxs2&#x3D;&#x2F;data&#x2F;httpd&#x2F;bin&#x2F;apxs \--with-xmlrpc \--with-iconv \--with-openssl \--with-mhash \--with-curl \--with-jpeg \--with-zlib \--with-freetype \--with-gettext \--without-gdbm \--without-pear \--enable-mbregex \--enable-mbstring \--enable-ftp \--enable-pcntl \--enable-soap \--enable-shared \--enable-shmop \--enable-sysvsem \--enable-gd \--enable-session \--enable-inline-optimization \--enable-opcache \--enable-fpm \--enable-fast-install \--enable-static \--enable-sockets \--enable-calendar \--enable-bcmath \--disable-maintainer-zts \--disable-debug \--disable-rpath \--disable-fileinfo \--disable-ipv6 \--disable-debug</code></pre><p><strong>编译安装</strong></p><pre class="language-none"><code class="language-none">make -j &#96;cat &#x2F;proc&#x2F;cpuinfo | grep &#39;processor&#39; | wc -l&#96;&amp;&amp; make install</code></pre><p><strong>配置文件</strong></p><pre class="language-none"><code class="language-none"># php.inicp php.ini-production &#x2F;data&#x2F;php&#x2F;etc&#x2F;php.inivim &#x2F;data&#x2F;php&#x2F;etc&#x2F;php.ini---post_max_size &#x3D; 64Mupload_max_filesize &#x3D; 64Mdate.timezone &#x3D; PRCcgi.fix_pathinfo&#x3D;1max_execution_time &#x3D; 300# php-fpm.confmv &#x2F;data&#x2F;php&#x2F;etc&#x2F;php-fpm.conf.default &#x2F;data&#x2F;php&#x2F;etc&#x2F;php-fpm.confmv &#x2F;data&#x2F;php&#x2F;etc&#x2F;php-fpm.d&#x2F;www.conf.default &#x2F;data&#x2F;php&#x2F;etc&#x2F;php-fpm.d&#x2F;www.confvim &#x2F;data&#x2F;php&#x2F;etc&#x2F;php-fpm.d&#x2F;www.conf---pm.start_servers &#x3D; 10pm.min_spare_servers &#x3D; 5pm.max_spare_servers &#x3D; 35pm.max_children &#x3D; 100</code></pre><h2 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h2><p><strong>解压源码包</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> apr-1.7.0.tar.gz <span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> apr-util-1.6.1.tar.gz <span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> httpd-2.4.53.tar.gz</code></pre><p><strong>进入解压后的目录</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">mv</span> apr-1.7.0 httpd-2.4.53/srclib/apr<span class="token function">mv</span> apr-util-1.6.1 httpd-2.4.53/srclib/apr-util</code></pre><p><strong>配置</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> httpd-2.4.53/</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash">./configure <span class="token punctuation">\</span><span class="token parameter variable">--prefix</span><span class="token operator">=</span>/data/httpd <span class="token punctuation">\</span>--enable-modules<span class="token operator">=</span>all <span class="token punctuation">\</span>--enable-mods-shared<span class="token operator">=</span>all <span class="token punctuation">\</span>--enable-cgi <span class="token punctuation">\</span>--enable-so <span class="token punctuation">\</span>--enable-rewrite <span class="token punctuation">\</span>--enable-ssl <span class="token punctuation">\</span>--enable-charset-lite <span class="token punctuation">\</span>--with-pcre</code></pre><p><strong>编译安装</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">make</span> <span class="token parameter variable">-j</span> <span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> /proc/cpuinfo <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'processor'</span> <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">`</span></span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span></code></pre><p><strong>配置环境变量</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> ~/.bashrc---<span class="token comment"># httpd</span><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span>:/data/httpd/bin/</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">source</span> ~/.bashrc</code></pre><p><strong>设置启动文件</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /data/httpd/bin/apachectl</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 添加</span><span class="token comment"># chkconfig: 35 85 21</span></code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> /data/httpd/bin/apachectl /etc/init.d/httpd<span class="token function">chmod</span> +x /etc/init.d/httpd</code></pre><p><strong>修改配置文件</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> httpd/conf/httpd.conf</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ServerName 设置为 localhost:80</span>ServerName localhost:80<span class="token comment"># &lt;IfModule mime_module> 段插入以下内容</span>AddType application/x-httpd-php .phpAddType application/x-httpd-php-source .phps<span class="token comment"># 修改首页文件名设置</span>DirectoryIndex index.html index.php<span class="token comment"># 载入 php7_module 模块</span>LoadModule php7_module modules/libphp7.so</code></pre><p><strong>启动服务</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">service</span> httpd start <span class="token operator">&amp;&amp;</span> <span class="token function">chkconfig</span> <span class="token parameter variable">--add</span> httpd</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /data/httpd/htdocs/test.php<span class="token operator">&lt;</span>?php    phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span></code></pre><p>访问测试页 <a href="http://10.11.109.201/test.php%EF%BC%8C%E8%A7%A3%E6%9E%90%E5%87%BAphpinfo%E9%A1%B5%E9%9D%A2%E8%A1%A8%E7%A4%BA%E6%88%90%E5%8A%9F">http://10.11.109.201/test.php，解析出phpinfo页面表示成功</a></p><p><img src="/2023/02/17/%E6%B5%8B%E8%AF%95%E9%A1%B5%E9%9D%A2/image-20230217141313610.png" alt="image-20230217141313610"></p><h2 id="WordPress"><a href="#WordPress" class="headerlink" title="WordPress"></a>WordPress</h2><p><strong>解压安装包</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> wordpress-6.0-zh_CN.tar.gz <span class="token parameter variable">-C</span> /data/httpd/htdocs/</code></pre><p>访问 <a href="http://10.11.109.201/wordpress">http://10.11.109.201/wordpress</a></p><p><img src="/2023/02/17/%E6%B5%8B%E8%AF%95%E9%A1%B5%E9%9D%A2/image-20230217141334409.png" alt="image-20230217141334409"></p><p><img src="/2023/02/17/%E6%B5%8B%E8%AF%95%E9%A1%B5%E9%9D%A2/image-20230217141343605.png" alt="image-20230217141343605"></p><p><img src="/2023/02/17/%E6%B5%8B%E8%AF%95%E9%A1%B5%E9%9D%A2/image-20230217141352887.png" alt="image-20230217141352887"></p><p><img src="/2023/02/17/%E6%B5%8B%E8%AF%95%E9%A1%B5%E9%9D%A2/image-20230217141400974.png" alt="image-20230217141400974"></p><p><img src="/2023/02/17/%E6%B5%8B%E8%AF%95%E9%A1%B5%E9%9D%A2/image-20230217141416265.png" alt="image-20230217141416265"></p><p><img src="/2023/02/17/%E6%B5%8B%E8%AF%95%E9%A1%B5%E9%9D%A2/image-20230217141425726.png" alt="image-20230217141425726"></p>]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/02/17/hello-world/"/>
      <url>/2023/02/17/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ hexo server</code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ hexo generate</code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ hexo deploy</code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hello </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
